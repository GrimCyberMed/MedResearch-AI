
> medresearch-ai@6.0.0-beta test
> node --test tests/test-ml-screening.js

ğŸ§ª ML-Based Citation Screening Tool - Test Suite

============================================================

ğŸš€ Starting ML-Based Citation Screening Tests...


ğŸ“‹ Test 1: Basic Screening with Clear Criteria
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 16 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 139 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 0 relevant, 0 uncertain, 8 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.3 hours
âœ… Total citations: 8
âœ… Likely relevant: 0
âœ… Uncertain: 0
âœ… Likely irrelevant: 8
âœ… Time saved: 0.3 hours
âœ… Processing time: 4ms

ğŸ“Š Top 3 Most Relevant Citations:

   1. C001: Efficacy of metformin in type 2 diabetes: a randomized contr...
      Score: 32.1%
      Recommendation: likely_irrelevant
      Matched terms: metformin, type, diabetes, randomized, controlled

   2. C002: Sulfonylureas versus metformin for glycemic control in type ...
      Score: 14.9%
      Recommendation: likely_irrelevant
      Matched terms: sulfonylureas, metformin, glycemic, control, type

   3. C006: Metformin and sulfonylurea combination therapy in type 2 dia...
      Score: 14.9%
      Recommendation: likely_irrelevant
      Matched terms: metformin, type, diabetes, sulfonylureas, glycemic

âŒ TEST FAILED: Did not correctly identify relevant citations

ğŸ“‹ Test 2: Screening with Narrow Criteria
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 9 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 141 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 0 relevant, 0 uncertain, 8 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.3 hours
âœ… Total citations: 8
âœ… Likely relevant: 0
âœ… Likely irrelevant: 8

ğŸ“Š Most Relevant Citation:
   C003: Cardiovascular outcomes with metformin in diabetes patients...
   Score: 36.4%

âœ… TEST PASSED: Correctly identified most relevant citation

ğŸ“‹ Test 3: Screening with Unrelated Criteria
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 7 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 143 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 0 relevant, 0 uncertain, 8 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.3 hours
âœ… Total citations: 8
âœ… Likely relevant: 0
âœ… Likely irrelevant: 8

âœ… TEST PASSED: Correctly identified unrelated citations as irrelevant

ğŸ“‹ Test 4: Testing Different Thresholds
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 6 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 138 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 1 relevant, 1 uncertain, 6 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.2 hours

   Threshold 0.5:
   - Likely relevant: 1
   - Uncertain: 1
   - Likely irrelevant: 6
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 6 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 138 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 1 relevant, 1 uncertain, 6 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.2 hours

   Threshold 0.7:
   - Likely relevant: 1
   - Uncertain: 1
   - Likely irrelevant: 6
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 6 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 138 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 1 relevant, 1 uncertain, 6 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.2 hours

   Threshold 0.9:
   - Likely relevant: 1
   - Uncertain: 1
   - Likely irrelevant: 6

âœ… TEST PASSED: Threshold correctly affects relevance classification

ğŸ“‹ Test 5: Performance Test (100 citations)
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 100 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 10 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 139 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: Screened 100/100 citations
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 0 relevant, 0 uncertain, 100 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 3.3 hours
âœ… Total citations: 100
âœ… Processing time: 3ms
âœ… Average time per citation: 0ms
âœ… Time saved: 3.3 hours

âœ… TEST PASSED: Performance within acceptable limits

ğŸ“‹ Test 6: Testing Recommendations Generation
------------------------------------------------------------
2025-12-13 13:41:32 [[32minfo[39m]: Starting ML-based screening for 8 citations
2025-12-13 13:41:32 [[32minfo[39m]: Inclusion criteria: 6 key terms
2025-12-13 13:41:32 [[32minfo[39m]: Calculated IDF for 138 unique terms
2025-12-13 13:41:32 [[32minfo[39m]: ML screening complete: 0 relevant, 0 uncertain, 8 irrelevant
2025-12-13 13:41:32 [[32minfo[39m]: Estimated time saved: 0.3 hours
âœ… Generated 4 recommendations:
   1. No citations met the relevance threshold of 70%
   2. Consider lowering the threshold or revising inclusion criteria
   3. Consider skipping 8 likely irrelevant citations (low priority)
   4. Estimated time saved: 0.3 hours

âœ… TEST PASSED: Recommendations generated correctly

============================================================
ğŸ“Š TEST SUMMARY
============================================================
âŒ Basic Screening
âœ… Narrow Criteria
âœ… Unrelated Criteria
âœ… Different Thresholds
âœ… Performance
âœ… Recommendations

============================================================
TOTAL: 5/6 tests passed (83%)
============================================================

âš ï¸ SOME TESTS FAILED. Please review the results above.

âœ– tests\test-ml-screening.js (159.5422ms)
â„¹ tests 1
â„¹ suites 0
â„¹ pass 0
â„¹ fail 1
â„¹ cancelled 0
â„¹ skipped 0
â„¹ todo 0
â„¹ duration_ms 168.9387

âœ– failing tests:

test at tests\test-ml-screening.js:1:1
âœ– tests\test-ml-screening.js (159.5422ms)
  'test failed'
